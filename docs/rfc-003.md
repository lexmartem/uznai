# RFC-003: Quiz Creation & Management

## Summary
This RFC covers the implementation of quiz creation and management functionality for the Uznai quiz platform. It builds upon the authentication and user profile systems established in RFC-002 to enable users to create, edit, and manage quizzes with various question types and privacy settings.

## Features Addressed
- F6: Manual Quiz Creation
- F7: Quiz Privacy Settings
- F8: Quiz Editing
- F9: Question Types

## Technical Approach

### Quiz Creation
1. Implement quiz creation functionality:
   - Form for collecting quiz metadata (title, description)
   - Interface for adding questions of different types
   - Drag-and-drop question reordering
   - Quiz privacy settings (public/private)
   - Quiz validation and error handling

2. Implement question type support:
   - Multiple choice (single answer)
   - Multiple choice (multiple answers)
   - True/False
   - Short answer (text)

3. Implement answer management:
   - Adding multiple answer options for questions
   - Marking correct answers
   - Setting answer order
   - Adding explanations for answers

### Quiz Management
1. Implement quiz listing and filtering:
   - Display user's created quizzes
   - Filter by creation date, title, privacy setting
   - Pagination for quiz list

2. Implement quiz editing:
   - Edit quiz metadata
   - Add/remove/edit questions
   - Change privacy settings
   - Update question order

3. Implement quiz deletion:
   - Soft delete functionality
   - Confirmation dialog
   - Recovery option (optional)

### Quiz Validation
1. Implement validation rules:
   - Quiz must have a title
   - Quiz must have at least one question
   - Questions must have text
   - Multiple choice questions must have at least two answers
   - Multiple choice questions must have at least one correct answer
   - True/False questions must have a correct answer marked

## API Contracts

### Quiz Endpoints

#### Create Quiz
```
POST /api/v1/quizzes
Request:
{
  "title": "string",
  "description": "string",
  "is_public": boolean
}
Response:
{
  "id": "UUID",
  "title": "string",
  "description": "string",
  "is_public": boolean,
  "created_at": "date-time",
  "updated_at": "date-time",
  "creator_id": "UUID"
}
Status: 201 Created
```

#### Get Quiz
```
GET /api/v1/quizzes/{id}
Response:
{
  "id": "UUID",
  "title": "string",
  "description": "string",
  "is_public": boolean,
  "created_at": "date-time",
  "updated_at": "date-time",
  "creator": {
    "id": "UUID",
    "username": "string"
  },
  "questions": [
    {
      "id": "UUID",
      "question_text": "string",
      "question_type": "string",
      "order_index": number,
      "answers": [
        {
          "id": "UUID",
          "answer_text": "string",
          "is_correct": boolean,
          "order_index": number
        }
      ]
    }
  ]
}
Status: 200 OK
```

#### Get User Quizzes
```
GET /api/v1/quizzes/me?page={page}&size={size}
Response:
{
  "content": [
    {
      "id": "UUID",
      "title": "string",
      "description": "string",
      "is_public": boolean,
      "created_at": "date-time",
      "updated_at": "date-time",
      "question_count": number
    }
  ],
  "page": number,
  "size": number,
  "total_pages": number,
  "total_elements": number
}
Status: 200 OK
```

#### Update Quiz
```
PUT /api/v1/quizzes/{id}
Request:
{
  "title": "string",
  "description": "string",
  "is_public": boolean
}
Response:
{
  "id": "UUID",
  "title": "string",
  "description": "string",
  "is_public": boolean,
  "created_at": "date-time",
  "updated_at": "date-time",
  "creator_id": "UUID"
}
Status: 200 OK
```

#### Delete Quiz
```
DELETE /api/v1/quizzes/{id}
Response: {}
Status: 204 No Content
```

### Question Endpoints

#### Add Question to Quiz
```
POST /api/v1/quizzes/{quizId}/questions
Request:
{
  "question_text": "string",
  "question_type": "string", // MULTIPLE_CHOICE_SINGLE, MULTIPLE_CHOICE_MULTIPLE, TRUE_FALSE, SHORT_ANSWER
  "order_index": number
}
Response:
{
  "id": "UUID",
  "question_text": "string",
  "question_type": "string",
  "order_index": number,
  "created_at": "date-time",
  "updated_at": "date-time"
}
Status: 201 Created
```

#### Update Question
```
PUT /api/v1/questions/{id}
Request:
{
  "question_text": "string",
  "question_type": "string",
  "order_index": number
}
Response:
{
  "id": "UUID",
  "question_text": "string",
  "question_type": "string",
  "order_index": number,
  "updated_at": "date-time"
}
Status: 200 OK
```

#### Delete Question
```
DELETE /api/v1/questions/{id}
Response: {}
Status: 204 No Content
```

### Answer Endpoints

#### Add Answer to Question
```
POST /api/v1/questions/{questionId}/answers
Request:
{
  "answer_text": "string",
  "is_correct": boolean,
  "order_index": number
}
Response:
{
  "id": "UUID",
  "answer_text": "string",
  "is_correct": boolean,
  "order_index": number,
  "created_at": "date-time",
  "updated_at": "date-time"
}
Status: 201 Created
```

#### Update Answer
```
PUT /api/v1/answers/{id}
Request:
{
  "answer_text": "string",
  "is_correct": boolean,
  "order_index": number
}
Response:
{
  "id": "UUID",
  "answer_text": "string",
  "is_correct": boolean,
  "order_index": number,
  "updated_at": "date-time"
}
Status: 200 OK
```

#### Delete Answer
```
DELETE /api/v1/answers/{id}
Response: {}
Status: 204 No Content
```

## Database Changes

### Question Types Enum
```sql
CREATE TYPE question_type AS ENUM (
  'MULTIPLE_CHOICE_SINGLE',
  'MULTIPLE_CHOICE_MULTIPLE',
  'TRUE_FALSE',
  'SHORT_ANSWER'
);

ALTER TABLE questions
ALTER COLUMN question_type TYPE question_type USING question_type::question_type;
```

### Questions Table Updates
```sql
-- Add explanation field to questions
ALTER TABLE questions ADD COLUMN explanation TEXT;
```

### Answers Table Updates
```sql
-- Add explanation field to answers
ALTER TABLE answers ADD COLUMN explanation TEXT;
```

## File Structure

### Backend Additions
```
com.uznai/
├── controller/
│   ├── QuizController.java
│   ├── QuestionController.java
│   └── AnswerController.java
├── dto/
│   ├── request/
│   │   ├── CreateQuizRequest.java
│   │   ├── UpdateQuizRequest.java
│   │   ├── CreateQuestionRequest.java
│   │   ├── UpdateQuestionRequest.java
│   │   ├── CreateAnswerRequest.java
│   │   └── UpdateAnswerRequest.java
│   └── response/
│       ├── QuizResponse.java
│       ├── QuizDetailsResponse.java
│       ├── QuizSummaryResponse.java
│       ├── QuestionResponse.java
│       └── AnswerResponse.java
├── service/
│   ├── impl/
│   │   ├── QuizServiceImpl.java
│   │   ├── QuestionServiceImpl.java
│   │   └── AnswerServiceImpl.java
│   ├── QuizService.java
│   ├── QuestionService.java
│   └── AnswerService.java
├── repository/
│   ├── QuizRepository.java
│   ├── QuestionRepository.java
│   └── AnswerRepository.java
├── mapper/
│   ├── QuizMapper.java
│   ├── QuestionMapper.java
│   └── AnswerMapper.java
└── entity/
    └── enums/
        └── QuestionType.java
```

### Frontend Additions
```
src/
├── app/
│   ├── quizzes/
│   │   ├── page.tsx                     # Quiz listing page
│   │   ├── new/page.tsx                 # Quiz creation page
│   │   ├── [id]/page.tsx                # Quiz detail page
│   │   └── [id]/edit/page.tsx           # Quiz edit page
├── components/
│   ├── quiz/
│   │   ├── QuizForm.tsx                 # Form for creating/editing quizzes
│   │   ├── QuizList.tsx                 # List of user's quizzes
│   │   ├── QuizItem.tsx                 # Individual quiz list item
│   │   ├── QuestionForm.tsx             # Form for adding/editing questions
│   │   ├── QuestionList.tsx             # List of questions in a quiz
│   │   ├── AnswerForm.tsx               # Form for adding/editing answers
│   │   └── AnswerList.tsx               # List of answers for a question
├── hooks/
│   ├── useQuizzes.ts                    # Hook for quiz operations
│   ├── useQuestions.ts                  # Hook for question operations
│   └── useAnswers.ts                    # Hook for answer operations
├── services/
│   ├── quiz-service.ts                  # API calls for quizzes
│   ├── question-service.ts              # API calls for questions
│   └── answer-service.ts                # API calls for answers
└── types/
    └── quiz.ts                          # Types for quiz-related data